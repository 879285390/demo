<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <header>
        欢迎使用
    </header>
    <main>
        <form name = "register_form" action="" method="post">

            ssid:<input type="text" name="ssid" maxlength="20" id="ssid"><br>
            pwd:<input type="text" name="pwd" maxlength="20" id="pwd"><br>
            aeskey：<input type="text" name="aeskey" maxlength="20"size="20"id="aeskey"><br>
            product_key：<input type="text" name="product_key" maxlength="20"size="20"id="product_key"><br>

            device_secret:<input name="device_secret" type="text" id="device_secret" size="50"><br>
            device_name:<input name="device_name" type="text" id="device_name" size="50"><br>
    
            <input name = "submit" type = "button"   value = "保存" onclick = check()>
    </form>

    <div class="alert">
        <strong id="status"></strong> 
    </div>
    
    </main>
    <footer>
        copyright 2021 Lyq | Czy
    </footer>
    <script>
        function check() {
        let userInfo = {}
        let status = document.querySelector('#status')
        var ws = new WebSocket('ws://localhost:8088');
        userInfo.ssid = register_form.ssid.value;
        userInfo.pwd = register_form.pwd.value;
        userInfo.aeskey = register_form.aeskey.value;
        userInfo.product_key = register_form.product_key.value;
        userInfo.device_secret = register_form.device_secret.value;
        userInfo.device_name = register_form.device_name.value;
        var msg = JSON.stringify({
            userInfo
        });
        ws.send(msg);
        }
        ws.onmessage = function(res) {
            if (res.status_code == 0) {
                status.innerHTML = res.msg
            } 
            else if (res.status_code == -1) {
                status.innerHTML = res.msg
            }
            else {
                alert("无法识别")
            }
        }
    </script>
</body>
</html>